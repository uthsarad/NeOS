# üõ°Ô∏è Sentinel: Basic Kernel Hardening

# Restrict dmesg access to users with CAP_SYSLOG (root)
# Prevents unprivileged users from viewing potential sensitive info in kernel logs
kernel.dmesg_restrict = 1

# Hide kernel symbol addresses (KASLR leakage prevention)
# Prevents attackers from identifying kernel memory layout
kernel.kptr_restrict = 2

# Restrict ptrace usage to parent processes only
# Prevents malware/users from inspecting/modifying other processes they own
kernel.yama.ptrace_scope = 1

# Disable ICMP redirects to prevent MITM attacks
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0

# Sentinel: BPF JIT Hardening
# Enable hardening for the BPF JIT compiler to mitigate JIT spraying attacks.
# 2 = enable + harden (blind constants)
net.core.bpf_jit_harden = 2

# Sentinel: File System Protection
# Prevent TOCTOU race conditions in world-writable sticky directories (like /tmp)
fs.protected_fifos = 2
fs.protected_regular = 2

# Sentinel: Additional File System Protection
# Prevent hardlink and symlink attacks in sticky directories
fs.protected_hardlinks = 1
fs.protected_symlinks = 1

# Sentinel: BPF Hardening
# Prevent unprivileged users from using eBPF (often used for kernel exploits)
kernel.unprivileged_bpf_disabled = 1

# Sentinel: Network Hardening
# Log packets with impossible addresses to kernel log
net.ipv4.conf.all.log_martians = 1

# Sentinel: Network Hardening
# Enable TCP SYN cookies to protect against SYN flood attacks
net.ipv4.tcp_syncookies = 1

# Sentinel: Network Hardening
# Enable Reverse Path Filtering to prevent IP spoofing
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1

# Sentinel: Network Hardening
# Disable ICMP redirects on default interfaces
net.ipv4.conf.default.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0

# Sentinel: Network Hardening
# Disable secure redirects (another type of redirect)
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.secure_redirects = 0

# Sentinel: Network Hardening
# Ignore ICMP echo requests sent to broadcast addresses (Smurf attack protection)
net.ipv4.icmp_echo_ignore_broadcasts = 1

# Sentinel: Network Hardening
# Disable IP source routing to prevent IP spoofing
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv6.conf.all.accept_source_route = 0
net.ipv6.conf.default.accept_source_route = 0

# Sentinel: Network Hardening
# Enable TCP Time-Wait Assassination protection
net.ipv4.tcp_rfc1337 = 1

# Sentinel: System Hardening
# Disable Magic SysRq key
kernel.sysrq = 0

# Sentinel: System Hardening
# Ensure core dump filenames include the PID
kernel.core_uses_pid = 1
