# üõ°Ô∏è Sentinel: Basic Kernel Hardening

# Restrict dmesg access to users with CAP_SYSLOG (root)
# Prevents unprivileged users from viewing potential sensitive info in kernel logs
kernel.dmesg_restrict = 1

# Hide kernel symbol addresses (KASLR leakage prevention)
# Prevents attackers from identifying kernel memory layout
kernel.kptr_restrict = 2

# Restrict ptrace usage to parent processes only
# Prevents malware/users from inspecting/modifying other processes they own
kernel.yama.ptrace_scope = 1

# Disable ICMP redirects to prevent MITM attacks
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0

# Sentinel: BPF JIT Hardening
# Enable hardening for the BPF JIT compiler to mitigate JIT spraying attacks.
# 2 = enable + harden (blind constants)
net.core.bpf_jit_harden = 2

# Sentinel: File System Protection
# Prevent TOCTOU race conditions in world-writable sticky directories (like /tmp)
fs.protected_fifos = 2
fs.protected_regular = 2

# Sentinel: Network Hardening
# Log packets with impossible addresses to kernel log
net.ipv4.conf.all.log_martians = 1
